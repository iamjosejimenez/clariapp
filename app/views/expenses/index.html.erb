<div class="max-w-5xl mx-auto p-6">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-xl font-semibold text-gray-800">
      Gastos de "<%= @budget.name %>" – <%= @budget_period.human_label %>
    </h1>

    <%= link_to new_budget_budget_period_expense_path(@budget, @budget_period),
        class: "inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-xl shadow hover:bg-blue-700" do %>
      <!-- Heroicon: plus -->
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 -ml-1" fill="none"
          viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 4v16m8-8H4" />
      </svg>
      Nuevo gasto
    <% end %>
  </div>

  <div class="mb-4 text-gray-700">
    <p><strong>Monto asignado:</strong> $<%= number_with_delimiter(@budget_period.total.to_i, delimiter: ".") %></p>
    <p><strong>Total gastado:</strong> <span class="text-red-600">$<%= number_with_delimiter(@budget_period.total_spent.to_i, delimiter: ".") %></span></p>
    <p><strong>Restante:</strong> $<%= number_with_delimiter(@budget_period.remaining.to_i, delimiter: ".") %></p>
  </div>

  <% if @expenses.any? %>
    <%= render TableComponent.new(rows: @expenses) do |table| %>
      <% table.with_column(name: "Descripción", classes: "text-left font-medium text-gray-900") do |expense| %>
        <%= expense.description %>
      <% end %>

      <% table.with_column(name: "Monto", classes: "text-left text-gray-700") do |expense| %>
        $<%= number_with_delimiter(expense.amount.to_i, delimiter: ".") %>
      <% end %>

      <% table.with_column(name: "Fecha", classes: "text-left text-gray-600") do |expense| %>
        <%= expense.created_at.strftime("%d/%m/%Y") %>
      <% end %>

      <% table.with_column(name: "Acciones", classes: "text-center") do |expense| %>
        <div class="flex items-center justify-center space-x-2">
          <%= link_to edit_expense_path(expense.id),
              title: "Editar gasto",
              class: "text-green-600 hover:text-green-800",
              data: { 'tippy-content': "Editar gasto al periodo actual" } do %>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
              <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325" />
            </svg>
          <% end %>
        </div>
      <% end %>
    <% end %>
  <% else %>
    <p class="text-gray-600 italic mt-4">No se han registrado gastos en este periodo.</p>
  <% end %>

  <div class="mt-6">
    <%= link_to "← Volver a presupuestos", budgets_path, class: "text-blue-600 hover:underline" %>
  </div>
</div>
